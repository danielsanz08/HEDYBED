{% extends "navbar.html" %}
{% block titulo %}Index{% endblock %}
{% load static %}
{% block contenido %}

<link href="{% static 'css/crear_transaccion.css' %}?v1.7" rel="stylesheet" />

<div class="container">
    <div class="login wrap">
        <form id="transaction-form" method="post" onsubmit="return handleSubmit(event)">
            {% csrf_token %}
            <h2>Registrar Nueva Transacción</h2><br>
            <div class="form-group">
                <label for="tipo"><h3>Tipo de Transacción</h3></label>
                <select name="tipo" required id="op_create">
                    <option value="" selected disabled>Selecciona una opción</option>
                    <option value="Compra">Compra</option>
                    <option value="Venta">Venta</option>
                    <option value="Gasto">Gasto</option>
                    <option value="Ingreso">Ingreso</option>
                </select>
            </div>
            <div class="form-group">
                <label for="descripcion"><h3>Descripción</h3></label>
                <input type="text" name="descripcion" placeholder="Ingresa una descripción" required id="op_create">
            </div>
            <div class="form-group">
                <label for="monto"><h3>Monto ($ COP)</h3></label>
                <input type="number" name="monto" step="0.01" placeholder="Ingresa el monto" required id="op_create">
            </div>
            <div class="form-group">
                <label for="fecha"><h3>Fecha</h3></label>
                <input type="date" id="fecha" name="fecha" required id="op_create">
            </div>
            <button type="submit" class="btn btn-success">Registrar Transacción</button>
            <a class="btn btn-warning" href="{% url 'contabilidad' %}" role="button">Volver</a>
        </form>
    </div>
</div>

<!-- Overlay Background -->
<div class="overlay"></div>

<!-- Alert Modal -->
<div id="alert" class="alert" style="display:none">
    <i class="fas fa-exclamation-triangle" id="alerta-icono"></i>
    <p><h4>Registro Exitoso</h4></p>
    <button onclick="cerrarVentana()"><h3>Ok</h3></button>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const inputFecha = document.getElementById('fecha');
        const today = new Date().toISOString().split('T')[0];
        inputFecha.setAttribute('min', today);
    });
    
    function handleSubmit(event) {
        event.preventDefault(); // Prevent the default form submission
        const form = document.getElementById('transaction-form');
        
        // Perform form validation if necessary
        // Assuming validation passes
        
        // Simulate form submission
        setTimeout(() => {
            mostrarAlerta();
        }, 1000); // Simulate a delay for demonstration purposes

        return false; // Prevent default form submission behavior
    }
    
    function mostrarAlerta() {
        document.getElementById("alert").style.display = 'block';
    }
    
    function cerrarVentana() {
        document.getElementById("alert").style.display = 'none';
    }
</script>

{% endblock %}
